<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href=".." rel="prev"/>
<link href="../base/" rel="next"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.7.1" name="generator"/>
<title>API Guide - Tree Machine</title>
<link href="../assets/stylesheets/main.484c7ddc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#api-guide">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Tree Machine" class="md-header__button md-logo" data-md-component="logo" href=".." title="Tree Machine">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Tree Machine
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              API Guide
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Tree Machine" class="md-nav__button md-logo" data-md-component="logo" href=".." title="Tree Machine">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Tree Machine
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
<span class="md-ellipsis">
    
  
    Home
  

    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    
  
    API Guide
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    
  
    API Guide
  

    
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#table-of-contents">
<span class="md-ellipsis">
      
        Table of Contents
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classifiercv">
<span class="md-ellipsis">
      
        ClassifierCV
      
    </span>
</a>
<nav aria-label="ClassifierCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shap-explanations">
<span class="md-ellipsis">
      
        SHAP Explanations
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#attributes-after-fit">
<span class="md-ellipsis">
      
        Attributes After Fit
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#regressioncv">
<span class="md-ellipsis">
      
        RegressionCV
      
    </span>
</a>
<nav aria-label="RegressionCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction_1">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict_1">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shap-explanations_1">
<span class="md-ellipsis">
      
        SHAP Explanations
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quantilecv">
<span class="md-ellipsis">
      
        QuantileCV
      
    </span>
</a>
<nav aria-label="QuantileCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction_2">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict_2">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-quantiles">
<span class="md-ellipsis">
      
        Multiple Quantiles
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-objects">
<span class="md-ellipsis">
      
        Configuration Objects
      
    </span>
</a>
<nav aria-label="Configuration Objects" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#classifiercvconfig-regressioncvconfig">
<span class="md-ellipsis">
      
        ClassifierCVConfig / RegressionCVConfig
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-configured-setups">
<span class="md-ellipsis">
      
        Pre-configured Setups
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-metrics">
<span class="md-ellipsis">
      
        Custom Metrics
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#constraints-and-advanced-options">
<span class="md-ellipsis">
      
        Constraints and Advanced Options
      
    </span>
</a>
<nav aria-label="Constraints and Advanced Options" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#monotonicity-constraints">
<span class="md-ellipsis">
      
        Monotonicity Constraints
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interaction-constraints">
<span class="md-ellipsis">
      
        Interaction Constraints
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-optimization-parameters">
<span class="md-ellipsis">
      
        Custom Optimization Parameters
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-a-validation-set">
<span class="md-ellipsis">
      
        Using a Validation Set
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-workflow-example">
<span class="md-ellipsis">
      
        Complete Workflow Example
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#predefined-metrics">
<span class="md-ellipsis">
      
        Predefined Metrics
      
    </span>
</a>
<nav aria-label="Predefined Metrics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#classification">
<span class="md-ellipsis">
      
        Classification
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#regression">
<span class="md-ellipsis">
      
        Regression
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../base/">
<span class="md-ellipsis">
    
  
    Base
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../classifier_cv/">
<span class="md-ellipsis">
    
  
    ClassifierCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../regression_cv/">
<span class="md-ellipsis">
    
  
    RegressionCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../quantile_cv/">
<span class="md-ellipsis">
    
  
    QuantileCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../custom_metrics/">
<span class="md-ellipsis">
    
  
    Custom Metrics
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deep_regression_trees/">
<span class="md-ellipsis">
    
  
    Deep Regression Trees (Experimental)
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deep_classification_trees/">
<span class="md-ellipsis">
    
  
    Deep Classification Trees (Experimental)
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    
  
    Appendix
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            
  
    Appendix
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../classification_metrics/">
<span class="md-ellipsis">
    
  
    Classification Metrics for ClassifierCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../regression_metrics/">
<span class="md-ellipsis">
    
  
    Regression Metrics for RegressionCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../explainer/">
<span class="md-ellipsis">
    
  
    ExplainerMixIn
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../optimizer_params/">
<span class="md-ellipsis">
    
  
    OptimizationParams
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../types/">
<span class="md-ellipsis">
    
  
    Types
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    
  
    About
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../license/">
<span class="md-ellipsis">
    
  
    License
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    
  
    API
  

    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api_base/">
<span class="md-ellipsis">
    
  
    Base
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api_classifier_cv/">
<span class="md-ellipsis">
    
  
    ClassifierCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api_regression_cv/">
<span class="md-ellipsis">
    
  
    RegressionCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api_quantile_cv/">
<span class="md-ellipsis">
    
  
    QuantileCV
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api_deep_regression/">
<span class="md-ellipsis">
    
  
    Deep Regression Trees (Experimental)
  

    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api_deep_classifier/">
<span class="md-ellipsis">
    
  
    Deep Classification Trees (Experimental)
  

    
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#table-of-contents">
<span class="md-ellipsis">
      
        Table of Contents
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classifiercv">
<span class="md-ellipsis">
      
        ClassifierCV
      
    </span>
</a>
<nav aria-label="ClassifierCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shap-explanations">
<span class="md-ellipsis">
      
        SHAP Explanations
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#attributes-after-fit">
<span class="md-ellipsis">
      
        Attributes After Fit
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#regressioncv">
<span class="md-ellipsis">
      
        RegressionCV
      
    </span>
</a>
<nav aria-label="RegressionCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction_1">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict_1">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#shap-explanations_1">
<span class="md-ellipsis">
      
        SHAP Explanations
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#quantilecv">
<span class="md-ellipsis">
      
        QuantileCV
      
    </span>
</a>
<nav aria-label="QuantileCV" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#construction_2">
<span class="md-ellipsis">
      
        Construction
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fit-and-predict_2">
<span class="md-ellipsis">
      
        Fit and Predict
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-quantiles">
<span class="md-ellipsis">
      
        Multiple Quantiles
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#configuration-objects">
<span class="md-ellipsis">
      
        Configuration Objects
      
    </span>
</a>
<nav aria-label="Configuration Objects" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#classifiercvconfig-regressioncvconfig">
<span class="md-ellipsis">
      
        ClassifierCVConfig / RegressionCVConfig
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-configured-setups">
<span class="md-ellipsis">
      
        Pre-configured Setups
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-metrics">
<span class="md-ellipsis">
      
        Custom Metrics
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#constraints-and-advanced-options">
<span class="md-ellipsis">
      
        Constraints and Advanced Options
      
    </span>
</a>
<nav aria-label="Constraints and Advanced Options" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#monotonicity-constraints">
<span class="md-ellipsis">
      
        Monotonicity Constraints
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#interaction-constraints">
<span class="md-ellipsis">
      
        Interaction Constraints
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#custom-optimization-parameters">
<span class="md-ellipsis">
      
        Custom Optimization Parameters
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-a-validation-set">
<span class="md-ellipsis">
      
        Using a Validation Set
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#complete-workflow-example">
<span class="md-ellipsis">
      
        Complete Workflow Example
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#predefined-metrics">
<span class="md-ellipsis">
      
        Predefined Metrics
      
    </span>
</a>
<nav aria-label="Predefined Metrics" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#classification">
<span class="md-ellipsis">
      
        Classification
      
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#regression">
<span class="md-ellipsis">
      
        Regression
      
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset"><a class="md-content__button md-icon" download="API Guide.pdf" href="index.pdf" title="Download as PDF"><html><body><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14 2 6 6v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm4 18V9h-5V4H6v16zm-6-1-4-4h2.5v-3h3v3H16z"></path></svg></body></html></a><a class="md-content__button md-icon" href="index.pdf" target="_blank" title="View as PDF"><html><body><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 .41.12.8.34 1.12.07.11.16.21.25.29.36.37.86.59 1.41.59h7.53c-.53-.58-.92-1.25-1.18-2H6V4h7v5h5v3c.7 0 1.37.12 2 .34V8zm4 21 5-4.5-3-2.7-2-1.8v3h-4v3h4z"></path></svg></body></html></a>
<h1 id="api-guide">API Guide</h1>
<p>This guide provides a practical overview of the Tree Machine API with runnable examples for each main component.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#classifiercv">ClassifierCV</a></li>
<li><a href="#regressioncv">RegressionCV</a></li>
<li><a href="#quantilecv">QuantileCV</a></li>
<li><a href="#configuration-objects">Configuration Objects</a></li>
<li><a href="#custom-metrics">Custom Metrics</a></li>
<li><a href="#constraints-and-advanced-options">Constraints and Advanced Options</a></li>
<li><a href="#using-a-validation-set">Using a Validation Set</a></li>
<li><a href="#complete-workflow-example">Complete Workflow Example</a></li>
</ul>
<hr/>
<h2 id="classifiercv">ClassifierCV</h2>
<p><code>ClassifierCV</code> performs automated classification with Bayesian hyperparameter optimization. It supports XGBoost and CatBoost backends.</p>
<h3 id="construction">Construction</h3>
<pre><code class="language-python">from tree_machine import ClassifierCV, default_classifier
from sklearn.model_selection import StratifiedKFold

classifier = ClassifierCV(
    metric="f1_macro",           # Metric to optimize: f1, f1_macro, precision, recall, etc.
    cv=StratifiedKFold(n_splits=5),
    n_trials=50,                 # Number of Optuna trials
    timeout=300,                 # Timeout in seconds (5 min)
    config=default_classifier,
    backend="xgboost",           # "xgboost" (default) or "catboost"
)
</code></pre>
<h3 id="fit-and-predict">Fit and Predict</h3>
<pre><code class="language-python">from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split

X, y = make_classification(n_samples=1000, n_features=20, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

classifier.fit(X_train, y_train)

# Class labels
predictions = classifier.predict(X_test)

# Probabilities (for binary: P(class=1), for multiclass: P per class)
probabilities = classifier.predict_proba(X_test)
</code></pre>
<h3 id="shap-explanations">SHAP Explanations</h3>
<pre><code class="language-python"># Returns dict with "mean_value" and "shap_values"
explanations = classifier.explain(X_test)
print(explanations["shap_values"].shape)  # (n_samples, n_features) or (n_samples, n_features, n_classes)
</code></pre>
<h3 id="attributes-after-fit">Attributes After Fit</h3>
<pre><code class="language-python"># Best hyperparameters found by Optuna
print(classifier.best_params_)

# CV scores for the best model (per fold)
print(classifier.cv_results)

# Feature importances from the underlying model
print(classifier.feature_importances_)

# Feature names (when X is a DataFrame)
print(classifier.feature_names_)
</code></pre>
<hr/>
<h2 id="regressioncv">RegressionCV</h2>
<p><code>RegressionCV</code> performs automated regression with the same optimization workflow.</p>
<h3 id="construction_1">Construction</h3>
<pre><code class="language-python">from tree_machine import RegressionCV, default_regression
from sklearn.model_selection import KFold

regressor = RegressionCV(
    metric="mse",                # mse, mae, mape, median
    cv=KFold(n_splits=5),
    n_trials=50,
    timeout=300,
    config=default_regression,
    backend="xgboost",
)
</code></pre>
<h3 id="fit-and-predict_1">Fit and Predict</h3>
<pre><code class="language-python">from sklearn.datasets import make_regression

X, y = make_regression(n_samples=1000, n_features=20, noise=0.1, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

regressor.fit(X_train, y_train)
predictions = regressor.predict(X_test)
</code></pre>
<h3 id="shap-explanations_1">SHAP Explanations</h3>
<pre><code class="language-python">explanations = regressor.explain(X_test)
# explanations["mean_value"]: baseline
# explanations["shap_values"]: (n_samples, n_features)
</code></pre>
<hr/>
<h2 id="quantilecv">QuantileCV</h2>
<p><code>QuantileCV</code> extends <code>RegressionCV</code> to predict a specific quantile (e.g., 90th percentile). It uses the pinball loss internally and shares <code>RegressionCVConfig</code>.</p>
<h3 id="construction_2">Construction</h3>
<pre><code class="language-python">from tree_machine import QuantileCV, default_regression
from sklearn.model_selection import KFold

# Predict the 90th percentile
quantile_regressor = QuantileCV(
    alpha=0.9,                   # Quantile level (0 &lt; alpha &lt; 1)
    cv=KFold(n_splits=5),
    n_trials=50,
    timeout=300,
    config=default_regression,   # Same config as RegressionCV
    backend="xgboost",
)
</code></pre>
<h3 id="fit-and-predict_2">Fit and Predict</h3>
<pre><code class="language-python">quantile_regressor.fit(X_train, y_train)
quantile_predictions = quantile_regressor.predict(X_test)  # 90th percentile estimates
</code></pre>
<h3 id="multiple-quantiles">Multiple Quantiles</h3>
<pre><code class="language-python"># Fit separate models for median (0.5) and 90th percentile (0.9)
median_model = QuantileCV(alpha=0.5, cv=KFold(5), n_trials=30, timeout=180, config=default_regression)
p90_model = QuantileCV(alpha=0.9, cv=KFold(5), n_trials=30, timeout=180, config=default_regression)

median_model.fit(X_train, y_train)
p90_model.fit(X_train, y_train)

median_pred = median_model.predict(X_test)
p90_pred = p90_model.predict(X_test)
</code></pre>
<hr/>
<h2 id="configuration-objects">Configuration Objects</h2>
<h3 id="classifiercvconfig-regressioncvconfig">ClassifierCVConfig / RegressionCVConfig</h3>
<p>Use these to customize monotonicity, interactions, and hyperparameter search space:</p>
<pre><code class="language-python">from tree_machine import ClassifierCVConfig, RegressionCVConfig, OptimizerParams

custom_config = ClassifierCVConfig(
    monotone_constraints={"age": 1, "risk_score": -1},  # 1=increasing, -1=decreasing
    interactions=[["age", "income"], ["risk_score", "age"]],  # Allowed interactions
    n_jobs=-1,                           # Parallel jobs (-1 = all cores)
    parameters=OptimizerParams(),        # Search space
    return_train_score=True,
)
</code></pre>
<h3 id="pre-configured-setups">Pre-configured Setups</h3>
<pre><code class="language-python">from tree_machine import default_classifier, balanced_classifier, default_regression, balanced_regression

# Default: full hyperparameter grid (performance-focused)
clf = ClassifierCV(metric="f1_macro", cv=..., n_trials=50, timeout=300, config=default_classifier)

# Balanced: more regularization, fewer params (better generalization)
clf = ClassifierCV(metric="f1", cv=..., n_trials=50, timeout=300, config=balanced_classifier)
</code></pre>
<hr/>
<h2 id="custom-metrics">Custom Metrics</h2>
<p>Pass a callable with signature <code>(y_true, y_pred) -&gt; float</code>:</p>
<pre><code class="language-python">from sklearn.metrics import accuracy_score, r2_score

# Classification
clf = ClassifierCV(
    metric=accuracy_score,
    cv=StratifiedKFold(5),
    n_trials=30,
    timeout=180,
    config=default_classifier,
)

# Regression: metrics are minimized. For R², negate: neg_r2 = lambda y_true, y_pred: -r2_score(y_true, y_pred)
def neg_r2(y_true, y_pred):
    from sklearn.metrics import r2_score
    return -r2_score(y_true, y_pred)

reg = RegressionCV(
    metric=neg_r2,
    cv=KFold(5),
    n_trials=30,
    timeout=180,
    config=default_regression,
)
</code></pre>
<p>Custom metrics must:</p>
<ul>
<li>Accept <code>(y_true, y_pred)</code> and return a float.</li>
<li><strong>Classification</strong>: metrics are maximized (higher is better).</li>
<li><strong>Regression</strong>: metrics are minimized (lower is better). Negate metrics like R² where higher is better.</li>
</ul>
<hr/>
<h2 id="constraints-and-advanced-options">Constraints and Advanced Options</h2>
<h3 id="monotonicity-constraints">Monotonicity Constraints</h3>
<p>Enforce monotonic relationships between features and the target:</p>
<pre><code class="language-python">custom_config = ClassifierCVConfig(
    monotone_constraints={"age": 1, "discount": -1},  # age↑ → outcome↑, discount↑ → outcome↓
    interactions=[],
    n_jobs=-1,
    parameters=OptimizerParams(),
    return_train_score=True,
)

classifier = ClassifierCV(metric="f1_macro", cv=..., n_trials=50, timeout=300, config=custom_config)
classifier.fit(X_train, y_train)
</code></pre>
<p>Use column names when <code>X</code> is a DataFrame; otherwise indices.</p>
<h3 id="interaction-constraints">Interaction Constraints</h3>
<p>Restrict which features can interact in splits:</p>
<pre><code class="language-python">custom_config = ClassifierCVConfig(
    monotone_constraints={},
    interactions=[["f1", "f2"], ["f3", "f4"]],  # Only these pairs can interact
    n_jobs=-1,
    parameters=OptimizerParams(),
    return_train_score=True,
)
</code></pre>
<h3 id="custom-optimization-parameters">Custom Optimization Parameters</h3>
<pre><code class="language-python">from tree_machine import OptimizerParams

custom_params = OptimizerParams(
    n_estimators=(100, 1000),
    max_depth=(3, 10),
    learning_rate=(0.01, 0.3),
    subsample=(0.8, 1.0),
    colsample_bytree=(0.8, 1.0),
    min_child_weight=(1, 10),
    gamma=(0.0, 1.0),
    reg_alpha=(0.0, 1.0),
    reg_lambda=(0.0, 1.0),
)

config = ClassifierCVConfig(
    monotone_constraints={},
    interactions=[],
    n_jobs=-1,
    parameters=custom_params,
    return_train_score=True,
)
</code></pre>
<hr/>
<h2 id="using-a-validation-set">Using a Validation Set</h2>
<p>Pass a validation set to <code>fit()</code> to optimize on it instead of CV:</p>
<pre><code class="language-python">classifier = ClassifierCV(
    metric="f1_macro",
    cv=StratifiedKFold(5),  # Ignored when validation set is provided
    n_trials=50,
    timeout=300,
    config=default_classifier,
)

classifier.fit(
    X_train, y_train,
    X_validation=X_val,
    y_validation=y_val,
)
</code></pre>
<hr/>
<h2 id="complete-workflow-example">Complete Workflow Example</h2>
<pre><code class="language-python">import pandas as pd
from sklearn.model_selection import StratifiedKFold, train_test_split
from sklearn.metrics import classification_report
from tree_machine import ClassifierCV, default_classifier

# Load or create data
X, y = ...  # Your features and target
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)

# Create and fit
clf = ClassifierCV(
    metric="f1_macro",
    cv=StratifiedKFold(n_splits=5, shuffle=True, random_state=42),
    n_trials=100,
    timeout=600,
    config=default_classifier,
    backend="xgboost",
)
clf.fit(X_train, y_train)

# Evaluate
y_pred = clf.predict(X_test)
print(classification_report(y_test, y_pred))
print(f"Best params: {clf.best_params_}")
print(f"CV scores: {clf.cv_results}")

# Explain
explanations = clf.explain(X_test)
shap_values = explanations["shap_values"]
</code></pre>
<hr/>
<h2 id="predefined-metrics">Predefined Metrics</h2>
<h3 id="classification">Classification</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>f1</code>, <code>f1_macro</code>, <code>f1_micro</code>, <code>f1_weighted</code></td>
<td>F1 score variants</td>
</tr>
<tr>
<td><code>precision</code>, <code>precision_macro</code>, <code>precision_micro</code>, <code>precision_weighted</code></td>
<td>Precision variants</td>
</tr>
<tr>
<td><code>recall</code>, <code>recall_macro</code>, <code>recall_micro</code>, <code>recall_weighted</code></td>
<td>Recall variants</td>
</tr>
</tbody>
</table>
<h3 id="regression">Regression</h3>
<table>
<thead>
<tr>
<th>Metric</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>mse</code></td>
<td>Mean squared error</td>
</tr>
<tr>
<td><code>mae</code></td>
<td>Mean absolute error</td>
</tr>
<tr>
<td><code>mape</code></td>
<td>Mean absolute percentage error</td>
</tr>
<tr>
<td><code>median</code></td>
<td>Median absolute error</td>
</tr>
<tr>
<td><code>quantile</code></td>
<td>Mean pinball loss (used internally by QuantileCV)</td>
</tr>
</tbody>
</table>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
</body>
</html>